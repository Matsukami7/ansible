- hosts: all
  become: yes
  become_user: root
  tasks:
    # Update apt cache
    - name: Update apt cache
      apt:
        update_cache: yes

    # Install Neofetch
    - name: Install Neofetch
      apt:
        name: neofetch
        state: present

    # Add Neofetch to .bashrc for user "narokuu"
    - name: Ensure Neofetch runs on startup for user "narokuu"
      lineinfile:
        path: /home/narokuu/.bashrc
        line: "neofetch"
        state: present
        create: yes
      become: yes
      become_user: narokuu

    # Reload .bashrc for user "narokuu"
    - name: Reload .bashrc for user "narokuu"
      shell: source /home/narokuu/.bashrc
      args:
        executable: /bin/bash
      become: yes
      become_user: narokuu

    # Modify Neofetch configuration for user "narokuu"
    - name: Ensure Neofetch config directory exists
      file:
        path: /home/narokuu/.config/neofetch
        state: directory
        owner: narokuu
        group: narokuu
        mode: '0755'

    - name: Create or update Neofetch config file
      copy:
        dest: /home/narokuu/.config/neofetch/config.conf
        content: |
          # Neofetch configuration file
          # See https://github.com/dylanaraps/neofetch/wiki/Customizing-Info for customization options

          # Default display options
          print_info() {
            info title
            info underline
            info "OS" distro
            info "Kernel" kernel
            info "Uptime" uptime
            info "Packages" packages
            info "Shell" shell
            info "Resolution" resolution
            info "DE" de
            info "WM" wm
            info "Theme" theme
            info "Icons" icons
            info "Terminal" term
            info "CPU" cpu
            info "Memory" memory
            info "Disk" disk
            info "IP Address" ip
          }
        owner: narokuu
        group: narokuu
        mode: '0644'